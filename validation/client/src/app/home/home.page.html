<ion-header>
  <ion-toolbar>
    <ion-title>
      Form Validation
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <form (submit)="register()" [formGroup]="registrationForm" novalidate>

    <ion-list>

      <ion-item>
        <ion-input [class.invalid]="isInvalidAndDirty('username')"
                   formControlName="username" label="Username"
                   labelPlacement="stacked" type="text"></ion-input>
      </ion-item>
      @if (hasError('username', 'required')) {
        <ion-item class="error-message">
          <ion-label>
            Username is required
          </ion-label>
        </ion-item>
      }
      @if (hasError('username', 'minlength')) {
        <ion-item class="error-message">
          <ion-label>
            Username must be at least 2 characters long
          </ion-label>
        </ion-item>
      }
      @if (hasError('username', 'maxlength')) {
        <ion-item class="error-message">
          <ion-label>
            Username cannot be longer than 30 characters
          </ion-label>
        </ion-item>
      }
      @if (hasError('username', 'usernameTaken')) {
        <ion-item class="error-message">
          <ion-label>
            Username is already taken
          </ion-label>
        </ion-item>
      }

      <ion-item>
        <ion-input [class.invalid]="isInvalidAndDirty('email')"
                   formControlName="email" label="Email"
                   labelPlacement="stacked" type="email"></ion-input>
      </ion-item>
      @if (hasError('email', 'required')) {
        <ion-item class="error-message">
          <ion-label>
            Email is required
          </ion-label>
        </ion-item>
      }
      @if (hasError('email', 'pattern')) {
        <ion-item class="error-message">
          <ion-label>
            Email is not valid
          </ion-label>
        </ion-item>
      }

      <ion-item>
        <ion-input [class.invalid]="isInvalidAndDirty('age')"
                   formControlName="age" label="Age"
                   labelPlacement="stacked" type="number"></ion-input>
      </ion-item>
      @if (hasError('age', 'required')) {
        <ion-item class="error-message">
          <ion-label>
            Age is required
          </ion-label>
        </ion-item>
      }
      @if (hasError('age', 'notOldEnough')) {
        <ion-item class="error-message">
          <ion-label>
            You must be at least {{ minAge }} years old!
          </ion-label>
        </ion-item>
      }

    </ion-list>

    <ion-button [disabled]="!registrationForm.valid" expand="block" type="submit">
      Create an Account
    </ion-button>

  </form>
</ion-content>
